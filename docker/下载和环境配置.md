## docker配置sglang镜像

### 安装docker

```bash
# 更新包索引
sudo apt update

# 安装Docker
sudo apt install docker.io

# 启动Docker服务
sudo systemctl start docker
sudo systemctl enable docker

# 将用户添加到docker组（避免每次使用sudo）
sudo usermod -aG docker $USER
# 重新登录或执行以下命令生效
newgrp docker
```

### Docker Hub无法连接

**配置国内镜像源**

打开或创建 `/etc/docker/daemon.json` 文件（Windows 系统路径为 `C:\ProgramData\Docker\config\daemon.json`）：

```bash
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-'EOF'
{
    "registry-mirrors": [
        "https://docker.m.daocloud.io",
        "https://hub-mirror.c.163.com",
        "https://dockerproxy.com",
        "https://docker.mirrors.ustc.edu.cn",
        "https://docker.nju.edu.cn"
    ]
}
EOF
```

**重启 Docker 服务**

保存文件后，重启 Docker 服务以应用更改：

```bash
sudo systemctl daemon-reload
sudo systemctl restart docker
```

**验证配置是否生效**

运行以下命令验证新的镜像源是否生效：

```bash
docker info | grep -A 10 "Registry Mirrors"
```

### 错误：docker: Error response from daemon: could not select device driver "" with capabilities: [[gpu]]

下载NVIDIA Container Toolkit

[官网教程](https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html)

sudo apt-get update时的网络连接问题：

终端配置代理

```bash
cat << EOF | sudo tee /etc/apt/apt.conf.d/proxy.conf
Acquire::http::Proxy "http://127.0.0.1:7897";
Acquire::https::Proxy "http://127.0.0.1:7897";
Acquire::https::nvidia.github.io::Verify-Peer "false";
Acquire::https::nvidia.github.io::Verify-Host "false";
EOF
```

配置docker以支持 NVIDIA GPU
"配置 Docker 容器运行时，让容器能够访问和使用宿主机的 NVIDIA GPU"

```bash
# 配置 Docker
sudo nvidia-ctk runtime configure --runtime=docker
# 重启 docker
sudo systemctl restart docker
```

### VS Code连接到容器

使用 Remote - Containers 扩展

- 打开 VS Code 
- 点击左侧扩展图标 (Extensions) 
- 搜索 "Remote Development" 
- 安装 **"Remote Development"** 扩展包

确保容器正在运行

```bash
docker ps
```

在 VS Code 中操作 

- 按 `F1`打开命令面板 
- 输入 "Attach to Running Container" 
- 选择您的容器 (如 `deepseek`) 
- VS Code 会在新窗口中打开容器
